<!DOCTYPE html>
<html lang="fr" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>ğŸ”® NEXUS v2 :: Station ECP â€” 117 cartes fact-checkÃ©es 2026</title>
<meta name="description" content="Station de travail ECP : 117 flashcards fact-checkÃ©es, benchmark europÃ©en, plaidoyer stratÃ©gique. DonnÃ©es sourcÃ©es fÃ©vrier 2026.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;700&family=Outfit:wght@300;500;700&family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
<style>
/* â•â•â• DESIGN TOKENS â€” #B!Mi DNA â•â•â• */
:root {
  --mg:#48bb78;--mg-d:#38a169;--mg-l:#68d391;
  --bg:#0d0d14;--bg2:#12121a;--bg3:#1a1a26;--bg4:#222233;
  --glow:0 0 10px rgba(72,187,120,.35),0 0 22px rgba(72,187,120,.15);
  --cyan:#63b3ed;--lilac:#b794f4;--orange:#f6ad55;--yellow:#faf089;
  --red:#fc8181;--ok:#68d391;--panel:rgba(13,13,20,.92);
  --glass:rgba(72,187,120,.05);--bd:rgba(72,187,120,.2);
  --lilac2:#9f7aea;--lilac-g:rgba(159,122,234,.25);
  --f-body:'Outfit',system-ui,sans-serif;
  --f-mono:'JetBrains Mono',monospace;
  --f-display:'Orbitron',sans-serif;
  --ease:cubic-bezier(.4,0,.2,1);
}
[data-t="80s"] {
  --mg:#00ff66;--mg-d:#00cc55;--mg-l:#39ff14;
  --bg:#0a0012;--bg2:#100020;--bg3:#180028;--bg4:#220038;
  --glow:0 0 10px #00ff66,0 0 25px #00ff66,0 0 50px #00ff66;
  --cyan:#00d4ff;--lilac:#ff00cc;--orange:#ff6600;--yellow:#ffff00;
  --red:#ff0040;--ok:#00ff88;--panel:rgba(10,0,18,.92);
  --glass:rgba(0,255,102,.08);--bd:rgba(0,255,102,.3);
  --lilac2:#ff00cc;--lilac-g:rgba(255,0,204,.3);
}

/* â•â•â• RESET â•â•â• */
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
html{scrollbar-width:thin;scrollbar-color:var(--mg) var(--bg)}
::-webkit-scrollbar{width:6px}::-webkit-scrollbar-track{background:var(--bg)}::-webkit-scrollbar-thumb{background:var(--mg);border-radius:3px}
::selection{background:var(--lilac);color:#fff}

body{font-family:var(--f-body);background:var(--bg);color:var(--mg);min-height:100vh;overflow-x:hidden;transition:background .4s var(--ease),color .4s var(--ease)}

/* â•â•â• SCANLINES â•â•â• */
.scan::before{content:'';position:fixed;inset:0;background:repeating-linear-gradient(0deg,rgba(0,0,0,.12),rgba(0,0,0,.12) 1px,transparent 1px,transparent 2px);pointer-events:none;z-index:9999}
[data-t="80s"] .scan::before{background:repeating-linear-gradient(0deg,rgba(0,0,0,.2),rgba(0,0,0,.2) 1px,transparent 1px,transparent 3px)}

/* â•â•â• LAYOUT â•â•â• */
.app{display:grid;grid-template-columns:260px 1fr 280px;grid-template-rows:54px 1fr;min-height:100vh;gap:1px;position:relative;z-index:1}
@media(max-width:1100px){.app{grid-template-columns:1fr;grid-template-rows:54px 1fr}}

/* â•â•â• HEADER â•â•â• */
.hdr{grid-column:1/-1;background:linear-gradient(180deg,var(--panel) 0%,rgba(13,13,20,.96) 100%);border-bottom:1px solid var(--bd);display:flex;align-items:center;justify-content:space-between;padding:0 16px;backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);z-index:10}
.logo{font-family:var(--f-display);font-size:1.2rem;font-weight:900;text-shadow:var(--glow);display:flex;align-items:center;gap:8px}
.logo-ic{width:34px;height:34px;border:2px solid var(--mg);border-radius:50%;display:flex;align-items:center;justify-content:center;animation:pulse 2s infinite}
@keyframes pulse{0%,100%{box-shadow:0 0 5px var(--mg)}50%{box-shadow:0 0 18px var(--mg),0 0 28px var(--mg-d)}}
.logo sub{font-size:.55rem;opacity:.5;font-weight:400;vertical-align:baseline;margin-left:4px}
.hdr-stats{display:flex;gap:20px;font-size:.75rem}
.st-v{font-size:1rem;font-weight:700;color:var(--cyan);text-shadow:0 0 8px var(--cyan);display:block;text-align:center}
.st-l{font-size:.55rem;opacity:.6;text-transform:uppercase;letter-spacing:.06em;text-align:center}
.hdr-act{display:flex;gap:6px;align-items:center}
@media(max-width:1100px){.hdr-stats{display:none}}

/* â•â•â• BUTTONS â•â•â• */
.btn{background:transparent;border:1px solid var(--bd);color:var(--mg);padding:6px 12px;cursor:pointer;font-family:var(--f-mono);font-size:.72rem;transition:all .25s var(--ease);border-radius:4px;position:relative;overflow:hidden;white-space:nowrap}
.btn:hover{background:rgba(72,187,120,.08);border-color:var(--mg);box-shadow:var(--glow);transform:translateY(-1px)}
.btn-cyan{border-color:var(--cyan);color:var(--cyan)}.btn-cyan:hover{background:rgba(99,179,237,.1);box-shadow:0 0 14px var(--cyan)}
.btn-danger{border-color:var(--red);color:var(--red)}.btn-danger:hover{background:rgba(252,129,129,.1)}

/* â•â•â• 80s TOGGLE â•â•â• */
.t80{background:var(--bg3);border:1px solid var(--bd);border-radius:50px;padding:3px 10px;display:inline-flex;align-items:center;gap:5px;cursor:pointer;color:var(--mg);font-family:var(--f-mono);font-size:.58rem;letter-spacing:.04em;transition:all .3s var(--ease)}
.t80:hover{border-color:var(--lilac2);box-shadow:0 0 12px var(--lilac-g)}
[data-t="80s"] .t80{border-color:var(--lilac);box-shadow:0 0 16px var(--lilac-g),inset 0 0 6px var(--lilac-g)}
.t80 .dot{width:7px;height:7px;border-radius:50%;background:var(--mg);transition:all .3s}
[data-t="80s"] .t80 .dot{background:var(--lilac);box-shadow:0 0 8px var(--lilac)}

/* â•â•â• SIDEBAR â•â•â• */
.side{background:var(--panel);border-right:1px solid var(--bd);padding:12px;overflow-y:auto;display:flex;flex-direction:column;gap:12px}
.side-r{background:var(--panel);border-left:1px solid var(--bd);padding:12px;overflow-y:auto;display:flex;flex-direction:column;gap:12px}
@media(max-width:1100px){.side,.side-r{display:none}.side.open,.side-r.open{display:flex;position:fixed;top:54px;bottom:0;width:280px;z-index:100}.side.open{left:0}.side-r.open{right:0}}

/* â•â•â• PROFILE â•â•â• */
.prof{background:linear-gradient(135deg,rgba(26,26,38,.9),rgba(13,13,20,.95));border:1px solid var(--bd);border-radius:10px;padding:14px;text-align:center}
.av{width:60px;height:60px;margin:0 auto 8px;border-radius:50%;border:2px solid var(--mg);background:var(--bg);display:flex;align-items:center;justify-content:center;font-size:1.6rem;cursor:pointer;transition:all .3s}
.av:hover{transform:scale(1.08);box-shadow:var(--glow)}
.pname{font-family:var(--f-display);font-size:.82rem;margin-bottom:2px}
.ptitle{font-size:.62rem;color:var(--cyan);margin-bottom:8px}
.xp-bar{background:rgba(0,0,0,.4);height:5px;border-radius:3px;overflow:hidden}
.xp-fill{height:100%;background:linear-gradient(90deg,var(--mg-d),var(--mg));transition:width .5s var(--ease)}
.xp-txt{font-size:.55rem;opacity:.6;margin-top:3px}

/* â•â•â• TOOL PANEL â•â•â• */
.tpanel{background:rgba(13,13,20,.5);border:1px solid var(--bd);border-radius:8px;overflow:hidden}
.tph{background:rgba(72,187,120,.06);padding:8px 12px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--bd);cursor:pointer;font-family:var(--f-body);font-weight:700;font-size:.78rem}
.tpc{padding:12px;max-height:250px;overflow-y:auto;font-size:.78rem}
.tpc.hide{display:none}

/* â•â•â• QUICK STATS â•â•â• */
.qgrid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.qstat{background:rgba(0,0,0,.25);padding:8px;border-radius:6px;text-align:center}
.qstat-v{font-size:1.1rem;font-weight:700}
.qstat-l{font-size:.5rem;opacity:.6;text-transform:uppercase}

/* â•â•â• MAIN CONTENT â•â•â• */
.main{background:rgba(13,13,20,.6);display:flex;flex-direction:column;overflow:hidden}
.toolbar{background:rgba(13,13,20,.85);padding:8px 14px;display:flex;align-items:center;gap:10px;border-bottom:1px solid var(--bd);flex-wrap:wrap}
.search-box{flex:1;min-width:180px;position:relative}
.search-in{width:100%;background:rgba(0,0,0,.4);border:1px solid var(--bd);color:var(--mg);padding:8px 12px 8px 32px;font-family:var(--f-body);font-size:.8rem;border-radius:4px;transition:all .25s}
.search-in:focus{outline:none;border-color:var(--mg);box-shadow:0 0 12px rgba(72,187,120,.2)}
.search-ic{position:absolute;left:10px;top:50%;transform:translateY(-50%);opacity:.5;font-size:.8rem}
.sort-sel{background:rgba(0,0,0,.4);border:1px solid var(--bd);color:var(--mg);padding:6px 10px;font-family:var(--f-mono);font-size:.7rem;border-radius:4px}
.view-tog{display:flex;gap:3px}
.vbtn{padding:6px 10px;background:transparent;border:1px solid var(--bd);color:var(--mg);cursor:pointer;transition:all .25s;border-radius:4px;font-size:.75rem}
.vbtn.on{background:rgba(72,187,120,.12);border-color:var(--mg)}

/* â•â•â• TABS â•â•â• */
.tabs{display:flex;background:rgba(0,0,0,.2);border-bottom:1px solid var(--bd);overflow-x:auto}
.tab{padding:10px 18px;cursor:pointer;border-bottom:2px solid transparent;transition:all .25s;font-weight:500;font-size:.78rem;white-space:nowrap}
.tab:hover{background:rgba(72,187,120,.06)}
.tab.on{border-bottom-color:var(--mg);background:rgba(72,187,120,.08);text-shadow:0 0 8px var(--mg)}

/* â•â•â• CONTENT AREA â•â•â• */
.content{flex:1;overflow-y:auto;padding:14px}

/* â•â•â• CARDS GRID â•â•â• */
.cgrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:12px}
@media(max-width:600px){.cgrid{grid-template-columns:1fr}}
.card{background:linear-gradient(135deg,rgba(26,26,38,.85),rgba(13,13,20,.92));border:1px solid var(--bd);border-radius:10px;overflow:hidden;transition:all .3s var(--ease);cursor:pointer;animation:fi .3s var(--ease) forwards}
@keyframes fi{from{opacity:0;transform:translateY(14px)}to{opacity:1;transform:translateY(0)}}
.card:hover{transform:translateY(-3px);box-shadow:0 8px 24px rgba(72,187,120,.12);border-color:var(--mg)}
.card.fav{border-color:var(--orange)}.card.done{border-color:var(--ok)}
.card.fc-c{border-color:rgba(252,129,129,.3)}.card.fc-c .c-hdr{background:rgba(252,129,129,.06)}
.card.bm-c{border-color:rgba(99,179,237,.2)}.card.bm-c .c-hdr{background:rgba(99,179,237,.04)}
.c-hdr{background:rgba(72,187,120,.05);padding:8px 12px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--bd)}
.c-id{font-family:var(--f-mono);font-size:.65rem;color:var(--cyan)}
.c-acts{display:flex;gap:6px}
.c-act{background:transparent;border:none;color:var(--mg);cursor:pointer;opacity:.5;transition:all .25s;font-size:.85rem}
.c-act:hover{opacity:1;transform:scale(1.15)}
.c-act.on-fav{color:var(--orange);opacity:1}
.c-act.on-done{color:var(--ok);opacity:1}
.c-q{padding:12px;font-size:.88rem;line-height:1.5;min-height:60px}
.c-a{padding:12px;background:rgba(0,0,0,.25);font-size:.8rem;color:var(--cyan);line-height:1.5;border-top:1px dashed var(--bd);display:none}
.c-a.vis{display:block}
.c-tags{padding:8px 12px;display:flex;flex-wrap:wrap;gap:4px}
.tag{padding:2px 8px;border-radius:20px;font-size:.58rem;font-family:var(--f-mono);cursor:pointer;transition:all .2s}
.tag:hover{filter:brightness(1.3)}

/* â•â•â• FACT-CHECK BADGES â•â•â• */
.fc{display:inline-flex;align-items:center;gap:2px;font-family:var(--f-mono);font-size:.52rem;padding:2px 6px;border-radius:50px;font-weight:600;letter-spacing:.02em;margin-left:5px}
.fc-ok{background:rgba(72,187,120,.1);color:var(--ok)}
.fc-warn{background:rgba(246,173,85,.1);color:var(--orange)}
.fc-err{background:rgba(252,129,129,.1);color:var(--red)}
.fc-new{background:rgba(159,122,234,.1);color:var(--lilac2)}
.fc-bm{background:rgba(99,179,237,.1);color:var(--cyan)}

/* â•â•â• SOURCE TAG â•â•â• */
.src{display:inline-block;font-family:var(--f-mono);font-size:.48rem;color:rgba(255,255,255,.2);background:rgba(255,255,255,.03);padding:1px 5px;border-radius:50px;margin:3px 2px 0 0}

/* â•â•â• TABLE VIEW â•â•â• */
.tbl{width:100%;border-collapse:collapse}
.tbl th,.tbl td{padding:8px 10px;text-align:left;border-bottom:1px solid var(--bd);font-size:.75rem}
.tbl th{background:rgba(72,187,120,.06);font-weight:700;cursor:pointer;user-select:none}
.tbl th:hover{background:rgba(72,187,120,.12)}
.tbl tr:hover{background:rgba(72,187,120,.03)}

/* â•â•â• QUIZ â•â•â• */
.quiz{max-width:660px;margin:0 auto}
.quiz-card{background:linear-gradient(135deg,rgba(26,26,38,.9),rgba(13,13,20,.95));border:2px solid var(--mg);border-radius:14px;padding:28px;text-align:center}
.quiz-q{font-size:1.15rem;line-height:1.6;margin:24px 0}
.quiz-ans{background:rgba(0,0,0,.4);border:1px solid var(--bd);border-radius:10px;padding:18px;margin:16px 0;display:none;color:var(--cyan);font-size:1rem}
.quiz-ans.vis{display:block}
.quiz-ctrl{display:flex;gap:12px;justify-content:center;margin-top:16px}
.quiz-score{display:flex;justify-content:center;gap:24px;margin-top:16px}
.sc-v{font-size:1.6rem;font-weight:700;display:block}.sc-ok{color:var(--ok)}.sc-no{color:var(--red)}

/* â•â•â• DETECTIVE â•â•â• */
.det-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px}
.det-card{background:rgba(13,13,20,.7);border:1px solid var(--bd);border-radius:10px;padding:16px}
.det-title{font-family:var(--f-display);font-size:.85rem;margin-bottom:12px;color:var(--cyan);display:flex;align-items:center;gap:6px}
.word-cloud{display:flex;flex-wrap:wrap;gap:6px;justify-content:center}
.word-item{padding:4px 10px;background:rgba(72,187,120,.08);border-radius:20px;cursor:pointer;transition:all .25s;font-size:.72rem}
.word-item:hover{background:rgba(72,187,120,.2);transform:scale(1.05)}
.chart-ct{height:180px;display:flex;align-items:flex-end;gap:3px;padding:8px 0}
.chart-bar{flex:1;background:linear-gradient(180deg,var(--mg),var(--mg-d));border-radius:3px 3px 0 0;min-height:6px;transition:all .3s;cursor:pointer;position:relative}
.chart-bar:hover{background:var(--cyan)}
.timeline-item{padding:8px 12px;border-left:2px solid var(--mg);margin-left:8px;margin-bottom:8px;position:relative;font-size:.78rem}
.timeline-item::before{content:'';position:absolute;left:-5px;top:12px;width:8px;height:8px;background:var(--mg);border-radius:50%}
.tl-year{color:var(--cyan);font-weight:700}

/* â•â•â• EDITOR â•â•â• */
.editor{max-width:700px;margin:0 auto}
.fg{margin-bottom:16px}
.fg label{display:block;margin-bottom:6px;font-weight:700;font-size:.82rem}
.fg input,.fg textarea,.fg select{width:100%;background:rgba(0,0,0,.4);border:1px solid var(--bd);color:var(--mg);padding:10px 12px;font-family:var(--f-body);font-size:.85rem;border-radius:4px;transition:all .25s}
.fg textarea{min-height:80px;resize:vertical}
.fg input:focus,.fg textarea:focus{outline:none;border-color:var(--mg);box-shadow:0 0 12px rgba(72,187,120,.2)}

/* â•â•â• CONNECTIONS â•â•â• */
.conn-ct{height:300px;position:relative;overflow:hidden}

/* â•â•â• FILTER TAGS â•â•â• */
.ftags{display:flex;flex-wrap:wrap;gap:4px;margin-bottom:10px}
.ftag{background:rgba(72,187,120,.06);border:1px solid var(--bd);padding:4px 10px;border-radius:20px;font-size:.62rem;cursor:pointer;transition:all .25s;font-family:var(--f-mono)}
.ftag:hover,.ftag.on{background:rgba(72,187,120,.18);border-color:var(--mg)}

/* â•â•â• SHORTCUTS â•â•â• */
.sc-list{font-size:.7rem}
.sc-item{display:flex;justify-content:space-between;padding:4px 0;border-bottom:1px solid rgba(72,187,120,.06)}
.sc-key{background:rgba(72,187,120,.12);padding:1px 6px;border-radius:3px;font-family:var(--f-mono);font-size:.6rem}

/* â•â•â• LEGEND â•â•â• */
.leg-item{display:flex;align-items:center;gap:8px;font-size:.7rem;cursor:pointer;padding:3px 0;transition:all .2s}
.leg-item:hover{color:var(--mg-l)}
.leg-dot{width:10px;height:10px;border-radius:3px;flex-shrink:0}
.leg-ct{margin-left:auto;opacity:.5;font-family:var(--f-mono);font-size:.6rem}

/* â•â•â• ACTIVITY LOG â•â•â• */
.log{max-height:160px;overflow-y:auto}
.log-e{padding:5px 0;border-bottom:1px solid rgba(72,187,120,.06);font-size:.65rem}
.log-t{color:var(--cyan);font-size:.55rem;font-family:var(--f-mono)}

/* â•â•â• MODAL â•â•â• */
.modal-bg{position:fixed;inset:0;background:rgba(0,0,0,.8);display:none;align-items:center;justify-content:center;z-index:1000}
.modal-bg.on{display:flex}
.modal{background:var(--panel);border:1px solid var(--mg);border-radius:14px;padding:24px;max-width:560px;width:92%;max-height:80vh;overflow-y:auto}
.modal h3{font-family:var(--f-display);font-size:1.1rem;margin-bottom:16px}
.modal-close{background:transparent;border:none;color:var(--mg);font-size:1.2rem;cursor:pointer;float:right}

/* â•â•â• NOTES â•â•â• */
.notes-ta{width:100%;height:80px;background:rgba(0,0,0,.4);border:1px solid var(--bd);color:var(--mg);padding:8px;font-family:var(--f-body);font-size:.75rem;resize:vertical;border-radius:4px}
.notes-ta:focus{outline:none;border-color:var(--mg);box-shadow:0 0 8px rgba(72,187,120,.2)}

/* â•â•â• TIMER â•â•â• */
.timer-d{font-family:var(--f-display);font-size:1.8rem;text-align:center;margin:8px 0;text-shadow:0 0 16px var(--cyan);color:var(--cyan)}
.timer-btns{display:flex;gap:4px;justify-content:center}
.timer-btns .btn{padding:4px 10px;font-size:.7rem}

/* â•â•â• DROP ZONE â•â•â• */
.drop-z{border:2px dashed var(--bd);border-radius:10px;padding:24px;text-align:center;transition:all .3s;margin-bottom:16px;font-size:.8rem}
.drop-z.dragover{border-color:var(--mg);background:rgba(72,187,120,.06)}

/* â•â•â• TOGGLE SWITCH â•â•â• */
.tog{width:42px;height:22px;background:rgba(0,0,0,.4);border-radius:11px;cursor:pointer;position:relative;transition:all .3s}
.tog.on{background:var(--mg)}
.tog::after{content:'';position:absolute;top:3px;left:3px;width:16px;height:16px;background:var(--bg);border-radius:50%;transition:all .3s}
.tog.on::after{left:23px}

/* â•â•â• CANVAS â•â•â• */
#rain{position:fixed;inset:0;pointer-events:none;z-index:0;opacity:.12}

/* â•â•â• RESPONSIVE HELPERS â•â•â• */
.desk-only{display:flex}
.mob-only{display:none}
@media(max-width:1100px){.desk-only{display:none!important}.mob-only{display:flex!important}}
</style>
</head>
<body class="scan">
<canvas id="rain"></canvas>

<div class="app">
<!-- â•â•â• HEADER â•â•â• -->
<header class="hdr">
  <div class="logo"><div class="logo-ic">â—ˆ</div><span>NEXUS</span><sub>ECP v2 Â· FACT-CHECKED 2026</sub></div>
  <div class="hdr-stats desk-only">
    <div><span class="st-v" id="st-total">117</span><span class="st-l">Cartes</span></div>
    <div><span class="st-v" id="st-done">0</span><span class="st-l">MaÃ®trisÃ©es</span></div>
    <div><span class="st-v" id="st-fav">0</span><span class="st-l">Favoris</span></div>
    <div><span class="st-v" id="st-time">00:00</span><span class="st-l">Session</span></div>
  </div>
  <div class="hdr-act">
    <button class="t80" onclick="toggle80s()"><span class="dot"></span><span id="t80-lbl">EIGHTIES</span></button>
    <button class="btn mob-only" onclick="toggleSide('l')">â˜°</button>
    <button class="btn btn-cyan" onclick="openModal('import')">ğŸ“¥</button>
    <button class="btn" onclick="exportCSV()">ğŸ“¤</button>
    <button class="btn" onclick="openModal('settings')">âš™ï¸</button>
    <button class="btn mob-only" onclick="toggleSide('r')">ğŸ“Š</button>
  </div>
</header>

<!-- â•â•â• LEFT SIDEBAR â•â•â• -->
<aside class="side" id="side-l">
  <div class="prof">
    <div class="av" id="avatar">ğŸ•µï¸</div>
    <div class="pname" contenteditable="true" id="pname">Agent_Inconnu</div>
    <div class="ptitle">DÃ©tective ECP</div>
    <div class="xp-bar"><div class="xp-fill" id="xp-fill" style="width:0%"></div></div>
    <div class="xp-txt"><span id="xp-cur">0</span> / <span id="xp-need">100</span> XP Â· Nv.<span id="pniv">1</span></div>
  </div>

  <div class="tpanel"><div class="tph" onclick="togPanel(this)">â±ï¸ CHRONO <span>â–¼</span></div>
  <div class="tpc">
    <div class="timer-d" id="timer">25:00</div>
    <div class="timer-btns">
      <button class="btn" onclick="timerStart()">â–¶</button>
      <button class="btn" onclick="timerPause()">â¸</button>
      <button class="btn" onclick="timerReset()">â†º</button>
    </div>
    <div style="margin-top:6px;text-align:center">
      <button class="btn" onclick="timerSet(25)" style="padding:2px 6px;font-size:.6rem">25m</button>
      <button class="btn" onclick="timerSet(15)" style="padding:2px 6px;font-size:.6rem">15m</button>
      <button class="btn" onclick="timerSet(5)" style="padding:2px 6px;font-size:.6rem">5m</button>
    </div>
  </div></div>

  <div class="tpanel"><div class="tph" onclick="togPanel(this)">ğŸ“Š STATS <span>â–¼</span></div>
  <div class="tpc">
    <div class="qgrid">
      <div class="qstat"><div class="qstat-v" id="cat-ecp" style="color:var(--mg)">0</div><div class="qstat-l">ECP</div></div>
      <div class="qstat"><div class="qstat-v" id="cat-az" style="color:var(--orange)">0</div><div class="qstat-l">Arizona</div></div>
      <div class="qstat"><div class="qstat-v" id="cat-fisc" style="color:var(--lilac)">0</div><div class="qstat-l">Fiscal</div></div>
      <div class="qstat"><div class="qstat-v" id="cat-bench" style="color:var(--cyan)">0</div><div class="qstat-l">Benchmark</div></div>
    </div>
  </div></div>

  <div class="tpanel"><div class="tph" onclick="togPanel(this)">ğŸ“ NOTES <span>â–¼</span></div>
  <div class="tpc">
    <textarea class="notes-ta" id="notes" placeholder="Notes personnelles..."></textarea>
    <button class="btn" style="margin-top:6px;width:100%" onclick="saveAll()">ğŸ’¾ Sauvegarder</button>
  </div></div>

  <div class="tpanel"><div class="tph" onclick="togPanel(this)">âŒ¨ï¸ RACCOURCIS <span>â–¼</span></div>
  <div class="tpc hide">
    <div class="sc-list">
      <div class="sc-item"><span>Recherche</span><span class="sc-key">Ctrl+F</span></div>
      <div class="sc-item"><span>Quiz</span><span class="sc-key">Q</span></div>
      <div class="sc-item"><span>DÃ©tective</span><span class="sc-key">D</span></div>
      <div class="sc-item"><span>Nouvelle carte</span><span class="sc-key">N</span></div>
      <div class="sc-item"><span>RÃ©ponse quiz</span><span class="sc-key">Espace</span></div>
      <div class="sc-item"><span>Carte suivante</span><span class="sc-key">â†’</span></div>
    </div>
  </div></div>
</aside>

<!-- â•â•â• MAIN â•â•â• -->
<main class="main">
  <div class="toolbar">
    <div class="search-box"><span class="search-ic">ğŸ”</span><input type="text" class="search-in" id="search" placeholder="Rechercher..."></div>
    <div class="view-tog">
      <button class="vbtn on" data-v="grid" onclick="setView('grid')">âŠ</button>
      <button class="vbtn" data-v="table" onclick="setView('table')">â˜°</button>
      <button class="vbtn" data-v="compact" onclick="setView('compact')">â–¤</button>
    </div>
    <select class="sort-sel" id="sort" onchange="sortCards(this.value)">
      <option value="id">Tri: ID</option>
      <option value="alpha">Tri: A-Z</option>
      <option value="random">Tri: AlÃ©atoire</option>
    </select>
  </div>
  <div class="tabs">
    <div class="tab on" data-tab="cards" onclick="switchTab('cards')">ğŸ“š CARTES</div>
    <div class="tab" data-tab="quiz" onclick="switchTab('quiz')">ğŸ¯ QUIZ</div>
    <div class="tab" data-tab="detective" onclick="switchTab('detective')">ğŸ” DÃ‰TECTIVE</div>
    <div class="tab" data-tab="editor" onclick="switchTab('editor')">âœï¸ Ã‰DITEUR</div>
  </div>
  <div class="content" id="content">
    <div id="p-cards"><div class="cgrid" id="cards-ct"></div></div>
    <div id="p-quiz" style="display:none"></div>
    <div id="p-det" style="display:none"></div>
    <div id="p-editor" style="display:none"></div>
  </div>
</main>

<!-- â•â•â• RIGHT SIDEBAR â•â•â• -->
<aside class="side-r" id="side-r">
  <div class="tpanel"><div class="tph">ğŸ·ï¸ CATÃ‰GORIES</div>
  <div class="tpc" id="cat-legend"></div></div>

  <div class="tpanel"><div class="tph">ğŸ”– FILTRES</div>
  <div class="tpc">
    <div class="ftags" id="status-filters">
      <span class="ftag on" onclick="filterStatus('all')">Toutes</span>
      <span class="ftag" onclick="filterStatus('fav')">â­ Favoris</span>
      <span class="ftag" onclick="filterStatus('done')">âœ“ MaÃ®trisÃ©es</span>
      <span class="ftag" onclick="filterStatus('todo')">â—‹ Ã€ revoir</span>
      <span class="ftag" onclick="filterStatus('fc')">ğŸ”¬ Fact-check</span>
      <span class="ftag" onclick="filterStatus('bench')">ğŸŒ Benchmark</span>
      <span class="ftag" onclick="filterStatus('new')">ğŸ†• Nouvelles v2</span>
    </div>
    <div class="ftags" id="theme-filters"></div>
  </div></div>

  <div class="tpanel"><div class="tph" onclick="togPanel(this)">ğŸ“‹ ACTIVITÃ‰ <span>â–¼</span></div>
  <div class="tpc"><div class="log" id="log"></div></div></div>
</aside>
</div>

<!-- â•â•â• MODALS â•â•â• -->
<div class="modal-bg" id="modal-import">
<div class="modal">
  <button class="modal-close" onclick="closeModals()">âœ•</button>
  <h3>ğŸ“¥ Importer des cartes</h3>
  <div class="drop-z" id="drop-z">Glissez un fichier CSV ici<br><small>Format : question,rÃ©ponse (une par ligne)</small></div>
  <input type="file" id="file-in" accept=".csv,.txt" style="display:none">
  <button class="btn btn-cyan" onclick="document.getElementById('file-in').click()">ğŸ“ Choisir un fichier</button>
</div></div>

<div class="modal-bg" id="modal-settings">
<div class="modal">
  <button class="modal-close" onclick="closeModals()">âœ•</button>
  <h3>âš™ï¸ ParamÃ¨tres</h3>
  <div style="margin-bottom:14px"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><span>Pluie matricielle</span><div class="tog on" id="tog-rain" onclick="togSetting(this,'rain')"></div></div></div>
  <div style="margin-bottom:14px"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><span>Scanlines</span><div class="tog on" id="tog-scan" onclick="togSetting(this,'scan')"></div></div></div>
  <div style="margin-bottom:14px"><div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><span>RÃ©ponses visibles</span><div class="tog" id="tog-ans" onclick="togSetting(this,'answers')"></div></div></div>
</div></div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DATA & STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let cards=[], filtered=[], view='grid', tab='cards', qIdx=0, qCards=[], qOk=0, qNo=0;
let sess=Date.now(), tInt=null, tSec=25*60, tRun=false;
let S={rain:true,scan:true,answers:false};
let prof={name:'Agent_Inconnu',level:1,xp:0,notes:''};

const CAT={
  'ECP':{c:'#48bb78',k:['ecp','contributive','provisionnÃ©e','contributeur','citoyen','fonds','nyxo','arc','piÃ¨ge institutionnel','provisionnement']},
  'Arizona':{c:'#f6ad55',k:['arizona','gouvernement','coalition','bart de wever','n-va','mr','engagÃ©s','vooruit','cd&v']},
  'Fiscal':{c:'#b794f4',k:['fiscal','taxe','impÃ´t','tva','prÃ©compte','budget','ruling','sda','onss','vvpr']},
  'Social':{c:'#faf089',k:['social','allocation','bim','cpas','chÃ´meur','pauvretÃ©','emploi','inami','onem','ris','volontariat','tmie']},
  'Tech':{c:'#68d391',k:['solid','fhir','nyxo','git','eleventy','pod','dÃ©centralisÃ©','decidim','sensor']},
  'Benchmark':{c:'#63b3ed',k:['tzcld','magma','basisbaan','sge berlin','marienthal','garantie emploi','territoir','ebe','groningen']},
  'Acteurs':{c:'#fc8181',k:['paradigm','athumi','dulbea','fgtb','csc','solidaris','vandenbroucke','syndicat','mutuelle','alliÃ©s']},
  'StratÃ©gie':{c:'#9f7aea',k:['swot','smart','thÃ©orie du changement','pourquoi','stratÃ©gie','roadmap','plaidoyer','objectif','cause racine','levier']},
};

const RAW=`Qu'est-ce que l'Ã‰conomie Contributive ProvisionnÃ©e (ECP) ?,Un modÃ¨le Ã©conomique permettant de valoriser les compÃ©tences des citoyens prÃ©caires sans leur faire perdre leurs droits sociaux.
Quel est le but principal de l'ECP face au systÃ¨me social actuel ?,RÃ©pondre au Â« piÃ¨ge institutionnel Â» qui dÃ©courage l'activitÃ© des personnes prÃ©carisÃ©es.
Le concept de l'ECP s'inscrit dans le contexte des rÃ©formes de quel gouvernement belge ?,Le gouvernement Arizona ($2025$-$2029$).
Quels sont les cinq partis qui forment la coalition Arizona ?,"La N-VA, le MR, Les EngagÃ©s, Vooruit et le CD&V."
Qui est le Premier ministre pressenti du gouvernement Arizona ?,Bart De Wever.
Quel est l'objectif de taux d'emploi du gouvernement Arizona pour $2029$ ?,$80\\%$.
Quel montant d'assainissement budgÃ©taire le gouvernement Arizona vise-t-il d'ici $2029$ ?,$18$ milliards d'euros.
Quel mÃ©canisme de l'ECP sÃ©pare l'acte de contribution de la perception immÃ©diate du revenu ?,Le provisionnement diffÃ©rÃ©.
OÃ¹ est bloquÃ©e la valeur monÃ©taire des actions citoyennes dans le modÃ¨le ECP ?,Dans un Fonds de Contribution Citoyenne.
Pourquoi les sommes accumulÃ©es en ECP ne rÃ©duisent-elles pas les allocations sociales ?,Elles ne sont pas considÃ©rÃ©es comme un revenu tant qu'elles ne sont pas encaissÃ©es par le contributeur.
"Pour garantir la sÃ©curitÃ© juridique de l'ECP, quelle procÃ©dure doit Ãªtre entamÃ©e auprÃ¨s du SPF Finances ?","Une demande de dÃ©cision anticipÃ©e, appelÃ©e Â« ruling fiscal Â»."
Quel organisme belge est compÃ©tent pour dÃ©livrer un ruling fiscal ?,Le Service des DÃ©cisions AnticipÃ©es (SDA).
Quelle est la durÃ©e minimale de validitÃ© d'une dÃ©cision du SDA (ruling fiscal) ?,$5$ ans.
Sur quelle loi de $2005$ l'ECP s'appuie-t-elle pour garantir l'absence de lien de subordination ?,La loi du $3$ juillet $2005$ relative aux droits des volontaires.
Quel est le coÃ»t d'une procÃ©dure de ruling auprÃ¨s du SDA ?,La procÃ©dure est gratuite et confidentielle.
Combien de personnes sont estimÃ©es en situation d'inactivitÃ© contrainte en Belgique selon l'ECP ?,"PrÃ¨s de $978\\,000$ personnes."
Quel est le coÃ»t annuel estimÃ© de l'inactivitÃ© pour l'Ã‰tat belge ?,"~$21,4$ Mrdâ‚¬/an ($2023$) = agrÃ©gation de $3$ sources : INAMI $13,0$ Mrdâ‚¬ + ONEM $6,46$ Mrdâ‚¬ + RIS/CPAS ~$2$ Mrdâ‚¬. Source : Cour des Comptes + ONEM + SPP IS."
Comment l'ECP appelle-t-elle le fait que le systÃ¨me actuel pÃ©nalise financiÃ¨rement l'initiative ?,Le piÃ¨ge institutionnel.
Quel est le nom du projet pilote de l'ECP axÃ© sur la santÃ© mentale ?,L'Agence de Renseignement Citoyenne (ARC).
Quel est le budget nÃ©cessaire pour lancer le projet pilote ARC ?,"$24\\,000$ euros."
Que signifie l'acronyme BIM dans le systÃ¨me de santÃ© belge ?,BÃ©nÃ©ficiaire de l'Intervention MajorÃ©e.
Quel est l'avantage principal du statut BIM pour les soins de santÃ© ?,Un remboursement plus important des frais mÃ©dicaux et le tiers payant social obligatoire.
Comment l'ECP assure-t-elle le maintien du statut BIM pour ses participants ?,En transformant le revenu immÃ©diat en un capital diffÃ©rÃ© non comptabilisÃ© par l'administration sociale.
Quel protocole de donnÃ©es dÃ©centralisÃ© est utilisÃ© par l'ECP pour garantir la souverainetÃ© des citoyens ?,Le protocole Solid.
Qui est l'inventeur du World Wide Web Ã  l'origine du projet Solid ?,Tim Berners-Lee.
Qu'est-ce qu'un Â« Pod Â» dans le contexte du protocole Solid ?,Un espace de stockage de donnÃ©es personnelles en ligne appartenant Ã  l'utilisateur.
Quel standard est utilisÃ© pour l'interopÃ©rabilitÃ© des services sociaux et de santÃ© dans l'ECP ?,Le standard FHIR ($HL7$).
Comment se nomme la plateforme technique qui sert de moteur Ã  l'ECP ?,NYXO.
Quel est le coÃ»t d'utilisation de la plateforme NYXO pour les citoyens ?,Elle est gratuite pour les citoyens.
Quel mÃ©canisme dÃ©mocratique Auderghem utilise-t-elle pour l'allocation de son budget partagÃ© ?,Le vote quadratique.
Quel est le montant du budget partagÃ© gÃ©rÃ© par la commune d'Auderghem ?,"Plus de $500\\,000$ euros."
Quelle technique est utilisÃ©e par NYXO pour archiver les flux de donnÃ©es publiques de maniÃ¨re inaltÃ©rable ?,Le Git Scraping.
Quel est le seuil de pauvretÃ© pour un isolÃ© en Belgique en $2024$ ?,"$1\\,522$ euros net par mois."
Quel pourcentage de la population belge est considÃ©rÃ© comme Ã©tant Ã  risque de pauvretÃ© ?,"$18,6\\%$."
Quel est le nombre approximatif de postes vacants en Belgique selon les donnÃ©es de $2024$ ?,"$172\\,000$ postes."
Quel est le principe de la Â« vÃ©ritÃ© administrative Â» dans l'ECP ?,Produire des donnÃ©es citoyennes vÃ©rifiables pour influencer les dÃ©cisions locales.
Pourquoi l'ECP garantit-elle une libertÃ© totale d'engagement (pas d'horaires imposÃ©s) ?,Pour Ã©viter toute requalification juridique en contrat de travail salariÃ©.
Quel est l'un des risques majeurs identifiÃ©s pour les chÃ´meurs participant Ã  l'ECP ?,Le risque que l'activitÃ© ne soit pas reconnue comme une recherche active d'emploi.
Quelle phase de la feuille de route ECP prÃ©voit la crÃ©ation d'un consortium formel en $2026$ ?,La Phase $2$ (Coalition).
Quel est l'objectif final de la Phase $3$ de l'ECP ($2027$-$2029$) ?,L'institutionnalisation via un cadre lÃ©gal reconnaissant le statut de Â« Contributeur Citoyen Â».
Quel concept Ã©conomique de Kate Raworth inspire le cadre Ã©thique de l'ECP ?,La ThÃ©orie du Donut.
Que signifie l'acronyme MCC dans le cadre de l'ECP ?,Monnaie Contributive Citoyenne.
"Dans le modÃ¨le ECP, qu'est-ce que la Â« liquidation Â» des fonds ?","Le moment oÃ¹ le contributeur retire les sommes accumulÃ©es, par exemple lors de son dÃ©part Ã  la pension."
Quel est l'avantage du modÃ¨le Â« B2B Â» validÃ© par le ruling fiscal pour un contributeur ?,"Il acte la nature commerciale et autonome de la prestation, protÃ©geant contre le lien de subordination."
Quels sont les plafonds de dÃ©fraiement du volontariat en $2026$ ?,"$44,02$ â‚¬/jour et $1\\,760,83$ â‚¬/an (standard). MajorÃ© : $3\\,233,91$ â‚¬/an. Sources : Securex, Liantis, Acerta janv. $2026$."
Quel est l'objectif de l'Ã©cart financier entre travail et non-travail visÃ© par l'Arizona ?,Atteindre une diffÃ©rence de plus de $500$ euros par mois.
Comment s'appelle la taxe sur les comptes-titres que le gouvernement Arizona prÃ©voit de doubler ?,La taxe d'abonnement.
Quel est le nouveau taux du prÃ©compte mobilier VVPRbis prÃ©vu par l'accord budgÃ©taire ?,$18\\%$.
Quel type de sociÃ©tÃ© est particuliÃ¨rement visÃ© par la rÃ©forme du VVPRbis ?,Les sociÃ©tÃ©s de management.
Quel est le montant total de l'effort budgÃ©taire global prÃ©vu par Les EngagÃ©s pour $2029$ ?,$23$ milliards d'euros.
Quelle rÃ©forme transforme le certificat mÃ©dical en document indiquant ce que le travailleur peut encore faire ?,La mise en place de la Â« fit note Â» (certificat d'aptitude).
Ã€ partir de quelle annÃ©e la dÃ©claration en temps rÃ©el des factures TVA deviendra-t-elle obligatoire ?,$2028$.
Quel est le taux de la nouvelle taxe sur les plus-values sur actifs financiers ?,$10\\%$.
Quelle technique fiscale pour les partenaires sans revenus sera rÃ©duite de moitiÃ© d'ici $2029$ ?,Le quotient conjugal.
Quel est le nouveau plafond d'heures pour le travail Ã©tudiant ?,$650$ heures par an.
Quel montant maximum de revenus nets un Ã©tudiant peut-il gagner sans que ses parents ne perdent d'avantages ?,"$12\\,000$ euros."
Quelle mesure permanente concerne la TVA pour la dÃ©molition et la reconstruction d'un logement ?,L'application du taux rÃ©duit de $6\\%$.
Comment s'appelle le nouveau principe fiscal qui permet aux contribuables de bonne foi de ne pas Ãªtre pÃ©nalisÃ©s pour une premiÃ¨re erreur ?,Le droit Ã  l'erreur.
Quel montant devra dÃ©sormais dÃ©bourser un candidat pour obtenir la nationalitÃ© belge ?,"$1\\,000$ euros (au lieu de $150$ euros)."
Quel est le dÃ©lai de prescription prÃ©vu en cas de suspicion de fraude fiscale ?,$7$ ans.
Quel outil informatique centralise toutes les aides et prestations sociales pour calculer le plafond par mÃ©nage ?,Le registre central.
Comment l'accord Arizona prÃ©voit-il d'augmenter le pouvoir d'achat via les chÃ¨ques-repas ?,En augmentant la contribution maximale lÃ©gale de deux fois $2$ euros.
Quelle taxe sera instaurÃ©e unilatÃ©ralement en $2027$ si aucun accord international n'est trouvÃ© ?,La digitaxe (taxe numÃ©rique).
Quelle institution est chargÃ©e de rÃ©Ã©crire et simplifier le code de l'impÃ´t sur le revenu ?,Une commission spÃ©ciale de simplification.
Quel service de mÃ©diation sera transformÃ© en Â« arbitrage fiscal Â» pour rÃ©duire les litiges ?,Le service de mÃ©diation fiscale.
"Dans le cadre de l'ECP, que reprÃ©sente un Â« crÃ©dit de voix Â» ?",Une unitÃ© de pouvoir dÃ©cisionnel gÃ©nÃ©rÃ©e par une action citoyenne positive.
Quelle ville belge a rÃ©cemment annoncÃ© un accord communal PS-Ecolo-PTB surnommÃ© la Â« Portugaise Â» ?,Mons.
Quel mouvement d'Ã©ducation permanente Ã©dite le magazine Â« Agir par la Culture Â» ?,PrÃ©sence et Action Culturelles (PAC).
Quelle organisation d'Ã©conomie sociale a Ã©tÃ© fondÃ©e par l'AbbÃ© Froidure en $1937$ ?,Les Petits Riens.
Comment s'appelle le journal d'investigation nÃ©erlandophone indÃ©pendant crÃ©Ã© en $2009$ ?,Apache.
Quelle instance mÃ©diatique a reÃ§u des centaines de plaintes aprÃ¨s une sÃ©quence polÃ©mique sur le CPAS ?,Le CSA (Conseil supÃ©rieur de l'audiovisuel).
Quel est le coÃ»t opÃ©rationnel modeste de l'infrastructure de l'ARC ?,"Environ $16\\,000$ euros par an."
Quelle technologie frugale est recommandÃ©e pour garantir l'accÃ¨s universel au portail NYXO ?,Eleventy ($11ty$).
Quel systÃ¨me remplace les astreintes lorsqu'un contribuable entrave une visite fiscale ?,L'application d'un bÃ©nÃ©fice imposable minimal.
Quelle rÃ©forme de Les EngagÃ©s vise Ã  crÃ©er un crÃ©dit de jours de congÃ© par enfant ?,La rÃ©forme Â« sac Ã  dos des congÃ©s familiaux Â».
Quel est le but de la Â« norme Ã©nergÃ©tique Â» renforcÃ©e par le budget Arizona ?,RÃ©duire la facture d'Ã©lectricitÃ© des entreprises belges exposÃ©es.
Quel organisme est mentionnÃ© comme partenaire pour le support de l'infrastructure Solid Ã  Bruxelles ?,Paradigm.
"Selon le FMI, sans intervention, vers quel type de budget se dirige la Belgique ?",Le pire budget de tous les pays industrialisÃ©s.
Quel est le taux d'endettement public par rapport au PIB prÃ©vu pour $2038$ sans rÃ©formes ?,$130\\%$.
Quelle procÃ©dure europÃ©enne a Ã©tÃ© dÃ©clenchÃ©e contre la Belgique en juin $2024$ ?,La procÃ©dure de dÃ©ficits excessifs.
Quel principe de justice fiscale est invoquÃ© pour faire contribuer les plus grandes fortunes ?,La contribution des Ã©paules les plus larges.
Quelle est la durÃ©e de la pÃ©riode d'ajustement budgÃ©taire choisie par la Belgique auprÃ¨s de l'UE ?,$7$ ans.
[FACT-CHECK] Le Â« dÃ©ficit sÃ©cu sociale $18,2$ Mrdâ‚¬ Â» est-il exact ?,"âŒ NON. $18,2$ Mrdâ‚¬ = dÃ©ficit EntitÃ© I (fÃ©dÃ©ral + sÃ©cu combinÃ©s). DÃ©ficit sÃ©cu seule = $5,5$-$6,2$ Mrdâ‚¬. Source : FEB oct. $2024$."
[FACT-CHECK] Le Â« $21$-$24$ Mrdâ‚¬ Â» est-il une citation de la Cour des Comptes ?,"âš ï¸ NON. AgrÃ©gation construite : INAMI $13,0$ Mrdâ‚¬ + ONEM $6,46$ Mrdâ‚¬ + RIS ~$2$ Mrdâ‚¬ = ~$21,4$ Mrdâ‚¬ ($2023$). MÃ©thodologiquement lÃ©gitime."
Quel est le TMIE fiscal pour un bÃ©nÃ©ficiaire AMI reprenant le travail ?,"$96,30\\%$ en fiscal pur. Source : CNT-NAR Dossier $3.032$-$21$ ($2021$)."
Quel est le TMIE fiscal pour un chÃ´meur reprenant le travail ?,"$90,13\\%$ en fiscal pur. Source : CNT-NAR Dossier $3.032$-$21$ ($2021$)."
Pourquoi dit-on que le TMIE peut dÃ©passer $100\\%$ ?,"En ajoutant la perte des droits dÃ©rivÃ©s (BIM, tarifs sociaux Ã©nergie, logement social). Source : CSE mars $2024$."
Ã€ quel rang mondial la Belgique se situe-t-elle pour le coin fiscal ?,"Rang $1$ sur $38$ pays OCDE avec $52,6\\%$. Source : OCDE Taxing Wages $2025$."
Qu'est-ce que le TZCLD en France ?,"Territoires ZÃ©ro ChÃ´meur de Longue DurÃ©e : $85$ territoires, $94$ EBE, $4\\,492$ CDI. Activation : $51\\%$. Source : DARES/Eval-Lab sept. $2025$."
Quel pourcentage de bÃ©nÃ©ficiaires TZCLD n'auraient pas trouvÃ© d'emploi sans le programme ?,"$74\\%$. Et $77\\%$ sans CDI $2$ ans aprÃ¨s. Source : DARES/Eval-Lab sept. $2025$."
Qu'est-ce que MAGMA de Gramatneusiedl (Autriche) ?,"$1$er RCT de garantie d'emploi ($2020$-$2024$). $112$ emplois, +$30\\%$ revenu. Source : Kasy & Lehner, IZA DP $16088$."
Qu'est-ce que la Basisbaan de Groningen (Pays-Bas) ?,"$170$ participants, zÃ©ro abandon (hors retraite). Philosophie la plus proche de l'ECP."
Qu'est-ce que le SGE de Berlin ?,"Solidarisches Grundeinkommen : $1\\,000$ emplois publics permanents ($2019$-$2025$)."
Qu'est-ce que TerritoiR'ES en Wallonie ?,"Adaptation belge TZCLD : $17$ territoires, $104$ Mâ‚¬ ($2022$-$2026$, UE/FSE+)."
Quelle est la diffÃ©rence structurelle TZCLD vs ECP ?,TZCLD = CDI au SMIC dans des EBE. ECP = statut allocataire maintenu + provisionnement diffÃ©rÃ©. Moins coÃ»teux par conception.
Quel est le coÃ»t par ETP du TZCLD ?,"~$28\\,000$ â‚¬/an. Activation $51\\%$ = $8\\,093$ â‚¬ Ã©conomies/pers/$12$ mois. Source : Eval-Lab/TAXIPP."
Le SDA est la cible principale du plaidoyer ECP. Pourquoi ?,Seule autoritÃ© habilitÃ©e Ã  dÃ©livrer un ruling fiscal sÃ©curisant le provisionnement diffÃ©rÃ©.
Qui est Frank Vandenbroucke dans la stratÃ©gie ECP ?,Ministre Affaires Sociales (Vooruit). Cible secondaire â€” socialiste sensible Ã  l'articulation ECP/sÃ©cu.
Quels sont les alliÃ©s stratÃ©giques du plaidoyer ECP ?,"FGTB/CSC (syndicats), Solidaris (mutuelle), Paradigm/Athumi (Solid), DULBEA-ULB (acadÃ©mique), fÃ©dÃ©rations CPAS."
Quelles sont les $3$ stratÃ©gies de pouvoir du plaidoyer ?,"AVEC (dialogue SDA, partenariats). SANS (pilote ARC, dÃ©ploiement tech). CONTRE (recours juridiques, campagne publique, UE)."
Quelle est la cause racine du piÃ¨ge institutionnel (analyse $5$ Pourquoi) ?,Rapport de force politique dÃ©favorable. SÃ©cu indexÃ©e sur salariat. Ruling sous-utilisÃ©. Coalition Arizona : punition > innovation.
Quels sont les $3$ leviers de la thÃ©orie du changement ECP ?,"$1$. Conscience (honteâ†’fiertÃ©). $2$. Politiques (ruling+statut ECP). $3$. Comportement (engagement valorisÃ©)."
Objectif SMART principal Q4 $2026$ ?,Ruling fiscal favorable SDA validant provisionnement diffÃ©rÃ© = non-revenu. Ã‰chÃ©ance : $31$/oct/$2026$.
Combien de contributeurs vise le pilote ARC ?,"$100$+ avec charte signÃ©e et missions documentÃ©es sur Pods Solid. Ã‰chÃ©ance : $15$/dÃ©c/$2026$."
Quels sont les $3$ critÃ¨res ONSS de requalification en contrat de travail ?,"Prestation, rÃ©munÃ©ration, subordination. La loi volontariat $2005$ garantit l'absence de subordination."
Qu'est-ce que l'article $344$ CIR $92$ ?,Disposition anti-abus fiscale. Le ruling SDA confirme que le provisionnement diffÃ©rÃ© â‰  abus.
Nombre exact de chÃ´meurs complets indemnisÃ©s $2024$ ?,"$292\\,790$ (moyenne mensuelle). Source : ONEM."
Combien en invaliditÃ© selon l'INAMI ?,"$526\\,507$ au $31/12/2023$. +$17,56\\%$ depuis $2019$. Source : INAMI."
Combien de bÃ©nÃ©ficiaires RIS ?,"$158\\,697$ (moyenne $2023$). DoublÃ© depuis $2003$. Source : SPP IS."
IndemnitÃ©s INAMI $2023$ â€” montant exact ?,"$13\\,035,8$ Mâ‚¬. Source : Cour des Comptes $181$e Cahier Part. II, oct. $2024$."
Le plafond majorÃ© volontariat est-il accessible aux allocataires sociaux ?,NON. LimitÃ©s au standard ($1\\,760,83$ â‚¬/an). Source : Securex/Liantis.
Quel budget pour prouver le concept ECP ?,"$24\\,000$ â‚¬ vs ~$21,4$ Mrdâ‚¬/an passifs. Ratio : $1$ pour ~$892\\,000$."
Quelle plateforme de dÃ©libÃ©ration utilise l'ECP ?,Decidim â€” open source, dÃ©mocratie participative (Â« dÃ©libÃ©ration liquide Â»).
Quel rÃ©seau de capteurs citoyens intÃ¨gre l'Ã©cosystÃ¨me ECP ?,Sensor.community â€” capteurs environnementaux citoyens (air, bruit, particules).`;

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PARSE & INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function parseCSV(txt){
  return txt.trim().split('\n').map((line,i)=>{
    const m=line.match(/^"?([^"]*)"?,(.*)$/)||line.match(/^([^,]*),(.*)$/);
    if(!m) return null;
    return{id:i+1,q:m[1].replace(/^"|"$/g,'').trim(),a:m[2].replace(/^"|"$/g,'').trim(),fav:false,done:false,cat:null,tags:[]};
  }).filter(Boolean);
}
function categorize(c){
  const t=(c.q+' '+c.a).toLowerCase();
  for(const[n,d]of Object.entries(CAT)){if(d.k.some(k=>t.includes(k))){c.cat=n;return;}}
  c.cat='Autre';
}
function fmt(s){return s.replace(/\$([^$]+)\$/g,'<span style="color:var(--cyan)">$1</span>').replace(/\\,/g,' ').replace(/\\%/g,'%')}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// RENDERING
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function render(){
  const ct=document.getElementById('cards-ct');
  if(view==='table'){renderTable(ct)}else{renderGrid(ct)}
  updateStats();
}

function renderGrid(ct){
  ct.className='cgrid';
  ct.style.gridTemplateColumns=view==='compact'?'repeat(auto-fill,minmax(260px,1fr))':'repeat(auto-fill,minmax(340px,1fr))';
  ct.innerHTML=filtered.map((c,i)=>{
    const isFC=c.q.startsWith('[FACT-CHECK]');
    const hasErr=c.a.includes('âŒ')||c.a.startsWith('NON');
    const hasWarn=c.a.includes('âš ï¸');
    const hasSrc=/Source[s]?\s*:/.test(c.a);
    const isBM=['TZCLD','MAGMA','Basisbaan','SGE','TerritoiR'].some(k=>c.q.includes(k)||c.a.includes(k));
    let badge='';
    if(isFC&&hasErr) badge='<span class="fc fc-err">âŒ CORRIGÃ‰</span>';
    else if(isFC&&hasWarn) badge='<span class="fc fc-warn">âš ï¸ NUANCÃ‰</span>';
    else if(isFC) badge='<span class="fc fc-ok">âœ… VÃ‰RIFIÃ‰</span>';
    else if(hasSrc) badge='<span class="fc fc-ok">âœ… SOURCÃ‰</span>';
    else if(isBM) badge='<span class="fc fc-bm">ğŸŒ BENCHMARK</span>';
    else if(c.id>82) badge='<span class="fc fc-new">ğŸ†• v2</span>';
    const srcM=c.a.match(/Source[s]?\s*:\s*([^.]+\.)/);
    const src=srcM?'<br><span class="src">'+srcM[1].trim()+'</span>':'';
    const cleanQ=c.q.replace('[FACT-CHECK] ','');
    const xcls=isFC?'fc-c':(isBM?'bm-c':'');
    const catC=CAT[c.cat]?.c||'var(--mg)';
    return `<div class="card ${xcls} ${c.fav?'fav':''} ${c.done?'done':''}" data-id="${c.id}" style="animation-delay:${i*.025}s">
<div class="c-hdr"><span class="c-id">#${String(c.id).padStart(3,'0')} ${badge}</span>
<div class="c-acts"><button class="c-act ${c.fav?'on-fav':''}" onclick="togFav(${c.id})">â­</button><button class="c-act ${c.done?'on-done':''}" onclick="togDone(${c.id})">âœ“</button></div></div>
<div class="c-q" onclick="togAns(${c.id})">${fmt(cleanQ)}</div>
<div class="c-a ${S.answers?'vis':''}" id="a-${c.id}">${fmt(c.a)}${src}</div>
<div class="c-tags"><span class="tag" style="background:${catC}25;color:${catC}">${c.cat||'â€”'}</span></div></div>`;
  }).join('');
}

function renderTable(ct){
  ct.className='';
  ct.innerHTML=`<table class="tbl"><thead><tr><th onclick="sortCards('id')">#</th><th onclick="sortCards('alpha')">Question</th><th>RÃ©ponse</th><th>Cat.</th><th>â­</th></tr></thead><tbody>${
    filtered.map(c=>`<tr><td>${c.id}</td><td style="cursor:pointer" onclick="togAns(${c.id})">${fmt(c.q.replace('[FACT-CHECK] ','')).substring(0,90)}â€¦</td><td id="a-${c.id}" class="c-a ${S.answers?'vis':''}" style="max-width:300px">${fmt(c.a).substring(0,80)}â€¦</td><td><span class="tag" style="background:${CAT[c.cat]?.c||'#666'}25;color:${CAT[c.cat]?.c||'#aaa'}">${c.cat||'â€”'}</span></td><td><button class="c-act ${c.fav?'on-fav':''}" onclick="togFav(${c.id})">â­</button></td></tr>`).join('')
  }</tbody></table>`;
}

function updateStats(){
  const d=cards.filter(c=>c.done).length, f=cards.filter(c=>c.fav).length;
  const el=id=>document.getElementById(id);
  el('st-total').textContent=cards.length;
  el('st-done').textContent=d;
  el('st-fav').textContent=f;
  // Category counts
  const cc={};cards.forEach(c=>{cc[c.cat]=(cc[c.cat]||0)+1});
  if(el('cat-ecp'))el('cat-ecp').textContent=cc['ECP']||0;
  if(el('cat-az'))el('cat-az').textContent=cc['Arizona']||0;
  if(el('cat-fisc'))el('cat-fisc').textContent=cc['Fiscal']||0;
  if(el('cat-bench'))el('cat-bench').textContent=cc['Benchmark']||0;
}

function renderLegend(){
  const ct=document.getElementById('cat-legend');
  const cc={};cards.forEach(c=>{cc[c.cat]=(cc[c.cat]||0)+1});
  ct.innerHTML=Object.entries(CAT).map(([n,d])=>`<div class="leg-item" onclick="filterCat('${n}')"><span class="leg-dot" style="background:${d.c}"></span><span>${n}</span><span class="leg-ct">${cc[n]||0}</span></div>`).join('');
}
function renderThemeFilters(){
  const ct=document.getElementById('theme-filters');
  ct.innerHTML=Object.keys(CAT).map(n=>`<span class="ftag" onclick="filterCat('${n}')">${n}</span>`).join('');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INTERACTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function togAns(id){const el=document.getElementById('a-'+id);if(el)el.classList.toggle('vis')}
function togFav(id){const c=cards.find(x=>x.id===id);if(c){c.fav=!c.fav;render();saveAll();logAct('Carte #'+id+(c.fav?' â­':' dÃ©sfavorisÃ©e'));addXP(5)}}
function togDone(id){const c=cards.find(x=>x.id===id);if(c){c.done=!c.done;render();saveAll();logAct('Carte #'+id+(c.done?' âœ“ maÃ®trisÃ©e':' Ã  revoir'));if(c.done)addXP(10)}}

function setView(v){view=v;document.querySelectorAll('.vbtn').forEach(b=>b.classList.toggle('on',b.dataset.v===v));render()}
function sortCards(by){
  if(by==='id')filtered.sort((a,b)=>a.id-b.id);
  else if(by==='alpha')filtered.sort((a,b)=>a.q.localeCompare(b.q));
  else if(by==='random')filtered.sort(()=>Math.random()-.5);
  render();
}
function filterCat(cat){filtered=cards.filter(c=>c.cat===cat);render();logAct('Filtre: '+cat)}
function filterStatus(st){
  document.querySelectorAll('#status-filters .ftag').forEach(f=>f.classList.remove('on'));
  event.target.classList.add('on');
  if(st==='all')filtered=[...cards];
  else if(st==='fav')filtered=cards.filter(c=>c.fav);
  else if(st==='done')filtered=cards.filter(c=>c.done);
  else if(st==='todo')filtered=cards.filter(c=>!c.done);
  else if(st==='fc')filtered=cards.filter(c=>c.q.startsWith('[FACT-CHECK]'));
  else if(st==='bench')filtered=cards.filter(c=>['TZCLD','MAGMA','Basisbaan','SGE','TerritoiR'].some(k=>c.q.includes(k)||c.a.includes(k)));
  else if(st==='new')filtered=cards.filter(c=>c.id>82);
  render();logAct('Filtre: '+st);
}

function switchTab(t){
  tab=t;
  document.querySelectorAll('.tab').forEach(x=>x.classList.toggle('on',x.dataset.tab===t));
  ['cards','quiz','det','editor'].forEach(p=>document.getElementById('p-'+p).style.display='none');
  if(t==='cards'){document.getElementById('p-cards').style.display='block'}
  else if(t==='quiz'){document.getElementById('p-quiz').style.display='block';initQuiz()}
  else if(t==='detective'){document.getElementById('p-det').style.display='block';renderDet()}
  else if(t==='editor'){document.getElementById('p-editor').style.display='block';renderEditor()}
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// QUIZ
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initQuiz(){
  qCards=[...filtered].sort(()=>Math.random()-.5);qIdx=0;qOk=0;qNo=0;renderQuizCard();
}
function renderQuizCard(){
  const ct=document.getElementById('p-quiz');
  if(!qCards.length){ct.innerHTML='<p style="text-align:center;opacity:.5">Aucune carte Ã  quizzer.</p>';return}
  const c=qCards[qIdx];
  ct.innerHTML=`<div class="quiz"><div class="quiz-card">
    <div style="display:flex;justify-content:space-between;font-size:.75rem;opacity:.6"><span>${qIdx+1}/${qCards.length}</span><span>Score: ${qOk}âœ“ ${qNo}âœ—</span></div>
    <div class="quiz-q">${fmt(c.q.replace('[FACT-CHECK] ',''))}</div>
    <div class="quiz-ans" id="quiz-ans">${fmt(c.a)}</div>
    <div class="quiz-ctrl">
      <button class="btn btn-cyan" onclick="quizReveal()">ğŸ‘ï¸ RÃ©ponse</button>
      <button class="btn" style="border-color:var(--ok);color:var(--ok)" onclick="quizRate(1)">âœ“ Savais</button>
      <button class="btn" style="border-color:var(--red);color:var(--red)" onclick="quizRate(0)">âœ— Savais pas</button>
      <button class="btn" onclick="quizNext()">â†’</button>
    </div>
    <div class="quiz-score"><div><span class="sc-v sc-ok">${qOk}</span><span style="font-size:.6rem;opacity:.5">Correct</span></div><div><span class="sc-v sc-no">${qNo}</span><span style="font-size:.6rem;opacity:.5">Incorrect</span></div></div>
  </div></div>`;
}
function quizReveal(){const el=document.getElementById('quiz-ans');if(el)el.classList.add('vis')}
function quizRate(ok){if(ok)qOk++;else qNo++;addXP(ok?10:3);quizNext()}
function quizNext(){qIdx=(qIdx+1)%qCards.length;renderQuizCard()}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// DETECTIVE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderDet(){
  const ct=document.getElementById('p-det');
  // Word frequency
  const words={};
  cards.forEach(c=>{(c.q+' '+c.a).toLowerCase().replace(/[^\wÃ Ã¢Ã¤Ã©Ã¨ÃªÃ«Ã¯Ã®Ã´Ã¹Ã»Ã¼Ã¿Ã§'-]/g,' ').split(/\s+/).forEach(w=>{if(w.length>4)words[w]=(words[w]||0)+1})});
  const top=Object.entries(words).sort((a,b)=>b[1]-a[1]).slice(0,30);
  const maxF=top[0]?top[0][1]:1;
  // Category chart
  const cc={};cards.forEach(c=>{cc[c.cat]=(cc[c.cat]||0)+1});
  const maxC=Math.max(...Object.values(cc),1);
  ct.innerHTML=`<div class="det-grid">
    <div class="det-card"><div class="det-title">â˜ï¸ NUAGE DE MOTS</div><div class="word-cloud">${top.map(([w,n])=>`<span class="word-item" style="font-size:${.6+n/maxF*.8}rem;opacity:${.4+n/maxF*.6}" onclick="searchWord('${w}')">${w}</span>`).join('')}</div></div>
    <div class="det-card"><div class="det-title">ğŸ“Š PAR CATÃ‰GORIE</div><div class="chart-ct">${Object.entries(cc).map(([n,v])=>`<div class="chart-bar" style="height:${v/maxC*100}%;background:${CAT[n]?.c||'var(--mg)'}" title="${n}: ${v}"></div>`).join('')}</div><div style="display:flex;justify-content:space-around;font-size:.5rem;opacity:.4">${Object.keys(cc).map(n=>`<span>${n.substring(0,5)}</span>`).join('')}</div></div>
    <div class="det-card"><div class="det-title">ğŸ“ˆ STATISTIQUES</div><div style="font-size:.78rem">
      <p>Total cartes : <strong>${cards.length}</strong></p>
      <p>MaÃ®trisÃ©es : <strong>${cards.filter(c=>c.done).length}</strong></p>
      <p>Favoris : <strong>${cards.filter(c=>c.fav).length}</strong></p>
      <p>Fact-check : <strong>${cards.filter(c=>c.q.includes('[FACT-CHECK]')).length}</strong></p>
      <p>Benchmark : <strong>${cards.filter(c=>['TZCLD','MAGMA','Basisbaan','SGE','TerritoiR'].some(k=>c.q.includes(k)||c.a.includes(k))).length}</strong></p>
      <p>Nouvelles v2 : <strong>${cards.filter(c=>c.id>82).length}</strong></p>
    </div></div>
  </div>`;
}
function searchWord(w){document.getElementById('search').value=w;doSearch(w)}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// EDITOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderEditor(){
  document.getElementById('p-editor').innerHTML=`<div class="editor">
    <h3 style="font-family:var(--f-display);margin-bottom:16px">âœï¸ Nouvelle carte</h3>
    <div class="fg"><label>Question</label><textarea id="ed-q" placeholder="Entrez la question..."></textarea></div>
    <div class="fg"><label>RÃ©ponse</label><textarea id="ed-a" placeholder="Entrez la rÃ©ponse..."></textarea></div>
    <button class="btn btn-cyan" onclick="addCard()">â• Ajouter la carte</button>
  </div>`;
}
function addCard(){
  const q=document.getElementById('ed-q').value.trim();
  const a=document.getElementById('ed-a').value.trim();
  if(!q||!a){alert('Question et rÃ©ponse requises');return}
  const c={id:cards.length+1,q,a,fav:false,done:false,cat:null,tags:[]};
  categorize(c);cards.push(c);filtered=[...cards];
  render();renderEditor();logAct('Carte #'+c.id+' crÃ©Ã©e');addXP(15);saveAll();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SEARCH
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function doSearch(q){
  q=q.toLowerCase();
  if(!q){filtered=[...cards]}
  else{filtered=cards.filter(c=>c.q.toLowerCase().includes(q)||c.a.toLowerCase().includes(q))}
  render();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// TIMER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function timerStart(){if(tRun)return;tRun=true;tInt=setInterval(()=>{if(tSec<=0){timerPause();alert('â° Temps Ã©coulÃ© !');return}tSec--;timerDisp()},1000)}
function timerPause(){tRun=false;clearInterval(tInt)}
function timerReset(){timerPause();tSec=25*60;timerDisp()}
function timerSet(m){timerPause();tSec=m*60;timerDisp()}
function timerDisp(){const m=Math.floor(tSec/60),s=tSec%60;document.getElementById('timer').textContent=String(m).padStart(2,'0')+':'+String(s).padStart(2,'0')}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// XP & PROFILE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function addXP(n){
  prof.xp+=n;
  const need=prof.level*100;
  if(prof.xp>=need){prof.level++;prof.xp-=need}
  document.getElementById('xp-cur').textContent=prof.xp;
  document.getElementById('xp-need').textContent=prof.level*100;
  document.getElementById('xp-fill').style.width=(prof.xp/(prof.level*100)*100)+'%';
  document.getElementById('pniv').textContent=prof.level;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ACTIVITY LOG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function logAct(msg){
  const ct=document.getElementById('log');
  const t=new Date().toLocaleTimeString('fr-BE',{hour:'2-digit',minute:'2-digit'});
  ct.insertAdjacentHTML('afterbegin',`<div class="log-e"><span class="log-t">${t}</span> ${msg}</div>`);
  if(ct.children.length>30)ct.lastChild.remove();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// PERSISTENCE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function saveAll(){
  try{
    const d={cards:cards.map(c=>({id:c.id,fav:c.fav,done:c.done})),prof,S};
    localStorage.setItem('nexus-v2',JSON.stringify(d));
  }catch(e){}
}
function loadAll(){
  try{
    const raw=localStorage.getItem('nexus-v2');
    if(!raw)return;
    const d=JSON.parse(raw);
    if(d.cards)d.cards.forEach(s=>{const c=cards.find(x=>x.id===s.id);if(c){c.fav=s.fav;c.done=s.done}});
    if(d.prof)Object.assign(prof,d.prof);
    if(d.S)Object.assign(S,d.S);
    document.getElementById('pname').textContent=prof.name||'Agent_Inconnu';
    document.getElementById('xp-cur').textContent=prof.xp;
    document.getElementById('pniv').textContent=prof.level;
    document.getElementById('xp-fill').style.width=(prof.xp/(prof.level*100)*100)+'%';
    if(prof.notes)document.getElementById('notes').value=prof.notes;
    if(!S.scan)document.body.classList.remove('scan');
    if(!S.rain)document.getElementById('rain').style.display='none';
  }catch(e){}
}
function exportCSV(){
  const csv=cards.map(c=>`"${c.q.replace(/"/g,'""')}","${c.a.replace(/"/g,'""')}"`).join('\n');
  const blob=new Blob([csv],{type:'text/csv'});
  const a=document.createElement('a');a.href=URL.createObjectURL(blob);a.download='nexus-ecp-v2.csv';a.click();
  logAct('Export CSV');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// IMPORT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function handleImport(file){
  const r=new FileReader();
  r.onload=function(e){
    const lines=e.target.result.trim().split('\n');
    let added=0;
    lines.forEach(line=>{
      const m=line.match(/^"?([^"]*)"?,(.*)$/);
      if(m){
        const c={id:cards.length+1,q:m[1].trim(),a:m[2].replace(/^"|"$/g,'').trim(),fav:false,done:false,cat:null,tags:[]};
        categorize(c);cards.push(c);added++;
      }
    });
    filtered=[...cards];render();renderLegend();
    logAct(added+' cartes importÃ©es');closeModals();
  };
  r.readAsText(file);
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// UI HELPERS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function togPanel(el){el.nextElementSibling.classList.toggle('hide')}
function toggleSide(s){document.getElementById('side-'+s).classList.toggle('open')}
function openModal(id){document.getElementById('modal-'+id).classList.add('on')}
function closeModals(){document.querySelectorAll('.modal-bg').forEach(m=>m.classList.remove('on'))}
function togSetting(el,key){
  el.classList.toggle('on');
  S[key]=el.classList.contains('on');
  if(key==='scan')document.body.classList.toggle('scan',S.scan);
  if(key==='rain')document.getElementById('rain').style.display=S.rain?'block':'none';
  if(key==='answers'){render()}
  saveAll();
}
function toggle80s(){
  const is80=document.documentElement.hasAttribute('data-t');
  if(is80){document.documentElement.removeAttribute('data-t');document.getElementById('t80-lbl').textContent='EIGHTIES'}
  else{document.documentElement.setAttribute('data-t','80s');document.getElementById('t80-lbl').textContent='CLASSIQUE'}
  initRain();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// MATRIX RAIN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function initRain(){
  const cv=document.getElementById('rain'),ctx=cv.getContext('2d');
  cv.width=window.innerWidth;cv.height=window.innerHeight;
  const chars='ã‚¢ã‚¤ã‚¦ã‚¨ã‚ªã‚«ã‚­ã‚¯ã‚±ã‚³ã‚µã‚·ã‚¹ã‚»ã‚½ã‚¿ãƒãƒ„ãƒ†ãƒˆ0123456789ABCDEF';
  const fs=14,cols=Math.floor(cv.width/fs),drops=Array(cols).fill(1);
  function draw(){
    ctx.fillStyle='rgba(13,13,20,.05)';ctx.fillRect(0,0,cv.width,cv.height);
    ctx.fillStyle=getComputedStyle(document.documentElement).getPropertyValue('--mg').trim()||'#48bb78';
    ctx.font=fs+'px monospace';
    for(let i=0;i<drops.length;i++){
      ctx.fillText(chars[Math.floor(Math.random()*chars.length)],i*fs,drops[i]*fs);
      if(drops[i]*fs>cv.height&&Math.random()>.975)drops[i]=0;
      drops[i]++;
    }
    requestAnimationFrame(draw);
  }
  draw();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// SESSION TIMER
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function sessTick(){
  const el=Date.now()-sess;
  const m=Math.floor(el/60000),s=Math.floor((el%60000)/1000);
  document.getElementById('st-time').textContent=String(m).padStart(2,'0')+':'+String(s).padStart(2,'0');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// KEYBOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
document.addEventListener('keydown',function(e){
  if(e.target.tagName==='INPUT'||e.target.tagName==='TEXTAREA')return;
  if(e.key==='q')switchTab('quiz');
  if(e.key==='d')switchTab('detective');
  if(e.key==='n')switchTab('editor');
  if(e.key===' '&&tab==='quiz'){e.preventDefault();quizReveal()}
  if(e.key==='ArrowRight'&&tab==='quiz')quizNext();
  if(e.ctrlKey&&e.key==='f'){e.preventDefault();document.getElementById('search').focus()}
});

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function(){
  cards=parseCSV(RAW);
  cards.forEach(categorize);
  filtered=[...cards];
  loadAll();
  render();
  renderLegend();
  renderThemeFilters();
  updateStats();
  initRain();
  setInterval(sessTick,1000);
  logAct('Session dÃ©marrÃ©e â€” '+cards.length+' cartes chargÃ©es');

  document.getElementById('search').addEventListener('input',function(e){doSearch(e.target.value)});
  document.getElementById('pname').addEventListener('blur',function(){prof.name=this.textContent;saveAll()});
  document.getElementById('notes').addEventListener('blur',function(){prof.notes=this.value;saveAll()});

  // Drop zone
  const dz=document.getElementById('drop-z');
  dz.addEventListener('dragover',function(e){e.preventDefault();dz.classList.add('dragover')});
  dz.addEventListener('dragleave',function(){dz.classList.remove('dragover')});
  dz.addEventListener('drop',function(e){e.preventDefault();dz.classList.remove('dragover');handleImport(e.dataTransfer.files[0])});
  document.getElementById('file-in').addEventListener('change',function(e){handleImport(e.target.files[0])});

  window.addEventListener('resize',function(){const cv=document.getElementById('rain');cv.width=window.innerWidth;cv.height=window.innerHeight});
})();
</script>
</body>
</html>
